<li><a class="active" href="#hierarchical">Hierarchical</a></li>
  <li><a href="#grouping">Grouping</a></li>
  <li><a href="#multilevelgrouping">Multi Level Grouping</a></li>
  <li><a href="#flat">Flat</a></li>
  <li><a href="#asyncloading">Async Loading</a></li>
  <li><a href="#refreshonscrollend">Refresh On Scroll End</a></li>
  <li><a href="#pagination">Pagination Demo</a></li>
  <li><a href="#mobileview">Mobile View</a></li>
  <li><a href="#multisortcolumn">Multi Column Sort</a></li>
  <li><a href="#editableGrid">Editable Grid</a></li>
  <li><a href="#editableMultipleGrid">Editable Multiple Grid</a></li>
  <li><a href="#editableRowGrid">Editable Row Grid</a></li>
  <li><a href="#editableGridWithInitiator">Editable Grid With Initiator</a></li>
  <li><a href="#editableMultipleRowGrid">Editable Multiple Row Grid</a></li>
  <li><a href="#editableRowGridWithInitiator">Editable Row Grid With Initiator</a></li>
  <li><a href="#groupingGridEditor">Grouping Grid Editor</a></li>
  <li><a href="#onDemandHierarchy">On Demand Hierarchy</a></li>
  <li><a href="#customIcons">Custom Icons</a></li>
  <li><a href="#customScroll">Custom Scroll</a></li>
  <li><a href="#filtered">Filter</a></li>
  <li><a href="#footer">Footer</a></li>
  <li><a href="#footerWithCustomScroll">Footer With CustomScroll</a></li>
  <li><a href="#export">Export Demo</a></li>
  <li><a href="#realTimeRefresh">Real Time Refresh</a></li>
  
  <script src="/JSLib/lib/com/org/util/nsXlsxExport.js"></script>
<script src="/JSLib/lib/com/org/util/nsZip.js"></script>

var arrRoute = [{route:"/hierarchical",templateUrl:"template/hierarchicalGrid.jsp",callback:"loadHierarchicalHandler",handler:loadTemplateRef},
	                {route:"/grouping",templateUrl:"template/groupingGrid.jsp",callback:"loadGroupHandler",handler:loadTemplateRef},
	                {route:"/multilevelgrouping",templateUrl:"template/multiLevelGroupingGrid.jsp",callback:"loadMultiLevelGroupHandler",handler:loadTemplateRef},
					{route:"/flat",templateUrl:"template/flatGrid.jsp",callback:"loadFlatHandler",handler:loadTemplateRef},
	                {route:"/asyncloading",templateUrl:"template/asyncLoading.jsp",callback:"loadAysncHandler",handler:loadTemplateRef},
	                {route:"/refreshonscrollend",templateUrl:"template/refreshOnScrollEnd.jsp",callback:"loadRefreshOnScrollEnd",handler:loadTemplateRef},
	                {route:"/pagination",templateUrl:"template/paginationDemo.jsp",callback:"loadPagination",handler:loadTemplateRef},
	                {route:"/multisortcolumn",templateUrl:"template/multiSortColumn.jsp",callback:"loadMultiSortColumnView",handler:loadTemplateRef},
	                {route:"/mobileview",templateUrl:"template/mobileView.jsp",callback:"loadMobileView",handler:loadTemplateRef},
	                {route:"/editableGrid",templateUrl:"template/editableGrid.jsp",callback:"loadEditableGrid",handler:loadTemplateRef},
	                {route:"/editableMultipleGrid",templateUrl:"template/editableGridMultiple.jsp",callback:"loadMultipleEditableGrid",handler:loadTemplateRef},
	                {route:"/editableRowGrid",templateUrl:"template/editableRowGrid.jsp",callback:"loadEditableRowGrid",handler:loadTemplateRef},
	                {route:"/editableGridWithInitiator",templateUrl:"template/editableGridWithInitiator.jsp",callback:"loadEditableGridWithInitiator",handler:loadTemplateRef},
	                {route:"/editableMultipleRowGrid",templateUrl:"template/editableRowGridMultiple.jsp",callback:"loadMultipleEditableRowGrid",handler:loadTemplateRef},
	                {route:"/editableRowGridWithInitiator",templateUrl:"template/editableRowGridWithInitiator.jsp",callback:"loadEditableRowGridWithInitiator",handler:loadTemplateRef},
	                {route:"/groupingGridEditor",templateUrl:"template/groupingGridEditor.jsp",callback:"loadGroupingEditorView",handler:loadTemplateRef},
	                {route:"/onDemandHierarchy",templateUrl:"template/onDemandHierarchy.jsp",callback:"loadOnDemandHierarchyHandler",handler:loadTemplateRef},
	                {route:"/customIcons",templateUrl:"template/customIconsGrid.jsp",callback:"loadCustomIconsHandler",handler:loadTemplateRef},
	                {route:"/customScroll",templateUrl:"template/customScroll.jsp",callback:"loadCustomScrollHandler",handler:loadTemplateRef},
	                {route:"/filtered",templateUrl:"template/filteredGrid.jsp",callback:"loadFilteredHandler",handler:loadTemplateRef},
	                {route:"/footer",templateUrl:"template/footerGrid.jsp",callback:"loadFooterHandler",handler:loadTemplateRef},
	                {route:"/footerWithCustomScroll",templateUrl:"template/footerGridWithCustomScroll.jsp",callback:"loadFooterGridWithCustomScrollHandler",handler:loadTemplateRef},
	                {route:"/export",templateUrl:"template/exportDemo.jsp",callback:"loadExportDemoHandler",handler:loadTemplateRef},
	                {route:"/realTimeRefresh",templateUrl:"template/realTimeRefreshGrid.jsp",callback:"loadRealTimeRefreshDemoHandler",handler:loadTemplateRef},
	                ];
                  
                  
                  var item = {id: rowCount, hierarchy: 'hierarchy ' + (rowCount+1).toString(), supervisor: null, country: 'US', employees: "Employee" + i, price: '10.90', year: '1985',date:new Date(2018, 11, i + 1),checked:true};
                  
                  enableColumnSetting:true,
                  
                  var column = [
		      		{headerText:"Id",dataField:"id",width:"20%",sortable:true,sortDescending:true,draggable:false,resizable:true,showMenu:true,minWidth:50,
		      		priority:1,editorSetting:{type:NSGrid.EDITOR_TYPE_CUSTOM,params:null,customEditor:"numericEditor",validator:null,isCellEditableCallback:null}},
		      		{headerText:"Country",dataField:"country",width:"15%",sortable:true,sortDescending:true,draggable:false,resizable:true,showMenu:true,priority:2},
		      		{headerText:"Hierarchy",dataField:"hierarchy",width:"20%",sortable:true,sortDescending:false,showMenu:true,headerTruncateToFit:true,
		      			truncateToFit:true,priority:1,editorSetting:{type:NSGrid.EDITOR_TYPE_TEXTAREA},multiSelectionEditor:NSGrid.MULTI_SELECTION_EDITORS_TEXTAREA},
		      		{headerText:"Year",dataField:"year",width:"20%",sortable:true,sortDescending:true,showMenu:true,priority:3},
		      		{headerText:"Employees",dataField:"employeesID",width:"30%",sortable:false,sortDescending:true,priority:4,
		      			itemRenderer:"employeeItemRenderer",groupRenderer:"employeeGroupRenderer",enableFilter:false,enableEditable:false},
		      		{headerText:"City",dataField:"city",width:"20%",sortable:true,sortDescending:true,showMenu:true,truncateToFit:true,priority:5},
		      		{headerText:"Address",dataField:"address",width:"30%",sortable:true,sortDescending:true,showMenu:true,truncateToFit:true,priority:5,
		      			editorSetting:{},itemRenderer:"addressRenderer"},
		      		{headerText:"Date",dataField:"date",width:"70%",sortable:true,sortDescending:true,showMenu:true,labelFunction:"dateLabelFunction",truncateToFit:true,priority:5},
		      		{headerText:"",dataField:"checked",width:"10%",draggable:false,sortable:false,sortDescending:false,itemRenderer:"itemRenderer",
		      			isExportable:false,showMenu:false,enableFilter:false,filter:{enableAdvancedFilter:false}
		      		 }
		      	];
	var multiLevelGroupColumn = {headerText:"Grouped Column",dataField:"group",width:"30%",resizable:true,autoSize:true,minWidth:50,priority:1};
	var setting = {nsTitle:"Multi Level Grouping Editable Grid Demo",type:"group",isSingleLevelGrouping:"false",enableEditable:true,
					enableVirtualScroll:true,groupByField:"country,year",enableCellSelection:true,
					enableFilter:true,enableAdvancedFilter:true,enableMouseHover:true,enableMultipleSelection:true,
					childField:"children",rowKeyField:"id",columnResizable:true,enableVariableRowHeight:false,
					columnDraggable:true,rowHeight:22,leftFixedColumn:0,rightFixedColumn:0,
					enableExport:true,enableResponsive:true,responsiveMode:"stack",multiLevelGroupColumn:multiLevelGroupColumn,showExpandCollapseIcon:true,
					heightOffset:200,customClass:{nonFirstBodyColumn:"nonFirstGridBodyCell"},
					editorSetting:{stopEditingOnGridFocusOut:true,clickType:NSGrid.EDITOR_EDITING_NOCLICK}};
	
  window["addressRenderer"] = function (data,dataField,rowIndex,columnIndex,row)
	{
		var address = data[dataField];
		var html = "<span><span style='display:inline-block;width:90px;text-overflow: ellipsis;white-space: nowrap;overflow:hidden !important;'>" + address + "</span><button style='float:right;'>Edit</button></span>";
		var div = document.createElement('div');
		div.innerHTML = html;
		var button = div.querySelectorAll("button")[0];
		button.addEventListener("click",function(event){
			nsGrid.editCellByItem(data,dataField);
			event.stopPropagation();
		});
        return div.firstElementChild;
	}
  
  <div>
	<!-- hierarchical,group,normal -->
	<!-- scroll,pages -->
	<!-- auto,manual -->
	<!-- stack,columnToggle -->
	<div id="dgDemo">
	</div> 
	<br/>
	<br/>
	<br/>
	<script>
		var column = [
		      		{headerText:"Id",dataField:"id",width:"200px",sortable:true,sortDescending:true,draggable:true,resizable:true,minWidth:50,priority:1,showMenu:true,
		      		 filter:{advancedFilterType:"number"},footerRenderer:"footerRenderer",exportGetFooterTextFunction:"exportFooterText",excelStyleFooterFunction: "excelStyleFooter",exportType:"number"},
		      		{headerText:"Country",dataField:"country",width:"200px",sortable:true,sortDescending:true,draggable:true,resizable:true,priority:2,showMenu:true,
		      					filter:{enableAdvancedFilter:true},autoSize:false,excelStyleHeaderFunction:"excelStyleHeader",excelStyleFooterFunction: "excelStyleFooter",exportType:"string"},
		      		{headerText:"Employees",dataField:"employees",width:"200px",sortable:false,sortDescending:true,headerTruncateToFit:true,
		      			      	truncateToFit:true,toolTipRenderer:"employeeToolTipRenderer",priority:4,showMenu:true,
		      			      	filter:{advancedFilterType:"list"}},//toolTipRenderer:employeeToolTipRenderer
		      		{headerText:"Price",dataField:"price",toolTipField:"price",width:"200px",sortable:true,sortDescending:true,priority:5
			      					,showMenu:true,enableFilter:false,footerRenderer:"footerRenderer",exportGetFooterTextFunction:"exportFooterText",excelStyleFooterFunction: "excelStyleFooter",exportType:"double"},
		      		{headerText:"Hierarchy",dataField:"hierarchy",width:"200px",sortable:true,sortDescending:false,priority:1,showMenu:true,
		      					filter:{enableAdvancedFilter:true,advancedFilterType:"list"},multiSelectionEditor:NSGrid.MULTI_SELECTION_EDITORS_TEXTAREA},
		      		{headerText:"Year",dataField:"year",width:"200px",sortable:true,sortDescending:true,priority:3,showMenu:true,
		      						filter:{advancedFilterType:"number"},footerRenderer:"footerRenderer",exportGetFooterTextFunction:"exportFooterText",
		      						excelStyleBodyFunction:"excelStyleBody",excelStyleFooterFunction: "excelStyleFooter",exportType:"integer"},
		      		{headerText:"Date",dataField:"date",width:"200px",sortable:true,sortDescending:true,labelFunction:"dateLabelFunction",priority:5,showMenu:true,
		      		 exportGetBodyTextFunction: "dateLabelExportTextFunction",excelStyleFooterFunction: "excelStyleFooter",exportType:"date" }
		      	];
		var setting = {nsTitle:"Grid Export Demo",enableFilter:true,enableAdvancedFilter:true,rowKeyField:"id",columnResizable:true,enableVariableRowHeight:true,
			           columnDraggable:true,rowHeight:30,enableResponsive:true,responsiveMode:"stack",heightOffset:250,customClass:{bodyCell:""},theme:"White",columnAutoSize:true,
			           leftFixedColumn:1,rightFixedColumn:1,enableFooter:true,enableExport:true
			           };
		var nsGrid = null;
		var arrItems = [];
		window["loadExportDemoHandler"] = function ()
		{
			var dgDemo = document.getElementById("dgDemo");
			nsGrid = new NSGrid(dgDemo,setting);
			arrItems = [];
			var item = {};
			for(var count = 0;count < 600;count++)
			{
				item = {id: count, hierarchy: 'Hierarchy ' + count, supervisor: "Supervisor " + count, country: 'UK', employees: "EmployeesEmployeesEmployees" + count, price: (10 * count), year: 1985 + count,checked:false};
				if((count % 2) === 0)
				{
					item["country"] = "US";
				}
				var date = new Date();
		        date.setFullYear(2015, Math.floor(Math.random() * 12), Math.floor(Math.random() * 27));
		        date.setHours(Math.floor(Math.random()*23), Math.floor(Math.random()*59), Math.floor(Math.random()*59), 0);
		        item["date"] = date;
				arrItems.push(item);
			}
			nsGrid.setColumn(column);
			nsGrid.dataSource(arrItems);
			nsGrid.fixFixedHeader();
		}
	
		window["dateLabelFunction"] = function (item,dataField,colItem)
		{
			if(item && item[dataField])
			{
				var date = item[dataField];
				return ((date.getMonth() + 1) + '/' + date.getDate() + '/' +  date.getFullYear());
			}
			return "";
		}
		
		window["employeeToolTipRenderer"] = function (item,dataField)
		{
			if(item && item[dataField])
			{
				return "<span>" + item[dataField] + "</span>";// );
			}
			return null;
		}
		
		window["footerRenderer"] = function(dataField,colItem,source,rowIndex,colIndex,cell,row)
		{
			var total = 0;
			if(source && source.length > 0)
			{
				var item = {};
				for(var count = 0;count < source.length;count++)
				{
					item = source[count];
					total += item[dataField];
				}
			}
			var htmlText = "" + total;
			return htmlText;
		}
		
		window["dateLabelExportTextFunction"] = function (item,dataField,colItem)
		{
			if(item && item[dataField])
			{
				var date = item[dataField];
				return ((date.getMonth() + 1) + '/' + date.getDate() + '/' +  date.getFullYear());
			}
			return "";
		}
		
		window["exportFooterText"] = function(dataField,colItem,source,rowIndex,colIndex)
		{
			var total = 0;
			if(source && source.length > 0)
			{
				var item = {};
				for(var count = 0;count < source.length;count++)
				{
					item = source[count];
					total += item[dataField];
				}
			}
			var text = "" + total;
			return text;
		}
		
		//Styles
		var headerStyle = {
				font: {bold: true, color: '#000000'},
				horizontal: 'center',
				pattern: {color: '#00FF00'},
				border: {left: {style:"thick",color: "#000000"},right: {style:"thick",color: "#000000"},top: {style:"thick",color: "#000000"},bottom: {style:"thick",color: "#000000"}}
		};
		
		var redStyle = {
				font: {name: "Calibri Light", underline: true, italic: true, color: '#ff0000'},
				border: {left: {style:"thin",color: "#5687f5"},right: {style:"thin",color: "#5687f5"},top: {style:"thin",color: "#5687f5"},bottom: {style:"thin",color: "#5687f5"}},
		};
		
		var darkGreyStyle = {
				pattern: {color: '#888888',patternType: "solid"},
				font: {name: "Calibri Light",color: '#ffffff'},
		};
		
		var footerStyle = {
				font: {size: 15, name: "Castellar",color: '#000000'},
		};
		
		window["excelStyleHeader"] = function(colItem,colIndex)
		{
			return headerStyle;
		}
		
		window["excelStyleBody"] = function(data,dataField,colItem,text)
		{
			text = parseInt(text);
			if((text % 2) == 0)
			{
				return redStyle;
			}
			return darkGreyStyle;
		}
		
		window["excelStyleFooter"] = function(dataField,colItem,source,rowIndex,colIndex,text)
		{
			return footerStyle;
		}
		
		
		//# sourceURL=exportDemo.js
	</script>
</div>
