var nsServerHierarchical = null;

function serverSideDemo()
				{
					var lstServerSideDemo = document.getElementById("lstServerSideDemo");
					var setting = {labelField:"label",enableHierarchical:true,enableVirtualScroll:false,enableDragDrop:false,
							isDraggable:true,isDroppable:false,
							enableMultipleSelection:true,enableKeyboardNavigation:true,customScrollerRequired:false,
			 		   		disableHoverField:"stopOver",enableDragAfterHold:true,holdTime:300,enableCloneMode:true,enableContextMenu:false,
			 		   		contextMenuProvider:contextMenuProvider,enableTruncateToFit:true,enableToolTipForTruncateText:true,
			 		   		toolTipRenderer:toolTipRenderer,
			 		   		enableOnDemandHierarchy:true,onDemandChildDetectionField:"hasChildren",onDemandChildFetchCallback:getNthLevelData};
					//, template:"templateDemo",setData:"setData",itemRenderer:itemRenderer
					//setting["dataSource"] = getFirstLevelData();
					nsServerHierarchical = new NSList(lstServerSideDemo,setting);
					
					var util= new NSUtil();
					var setting =  {
						method: "GET",
						//url: "http://api.flickr.com/services/feeds/photos_public.gne",
						url: "http://www.itis.gov/ITISWebService/jsonservice/getKingdomNames",
						dataType: "jsonp",
						param: {
							jsonp: "getParentData"
						},
						successHandler: function( data ) {
							console.log(data);
							//response( data );
						}
					};
					var ajax = new util.ajax(setting);
				}
				
				var lastItem = null;
				function getParentData(result)
				{
					var arrSource = [];
					if(result && result.kingdomNames)
					{
						for(var count = 0;count < result.kingdomNames.length;count++)
						{
							var tempItem = result.kingdomNames[count];
							if(tempItem)
							{
								var item = {label:tempItem.kingdomName,tsn:tempItem.tsn,detail:tempItem,hasChildren:true};
								arrSource.push(item);
							}
						}
					}
					nsServerHierarchical.dataSource(arrSource);
					
					console.log(result);
				}
				
				function getNthLevelData(item,rowIndex,rowLevel,event)
				{
					var util= new NSUtil();
					lastItem = {item:item,rowIndex:rowIndex,rowLevel:rowLevel,event:event};
					var setting =  {
						method: "GET",
						//url: "http://api.flickr.com/services/feeds/photos_public.gne",
						url: "http://www.itis.gov/ITISWebService/jsonservice/getHierarchyDownFromTSN",
						dataType: "jsonp",
						param: {
							jsonp: "getChildData",
							tsn: item.tsn
						},
						successHandler: function( data ) {
							console.log(data);
							//response( data );
						}
					};
					var ajax = new util.ajax(setting);
				}
				
				function getChildData(result)
				{
					var arrSource = [];
					if(lastItem)
					{
						if(result && result.hierarchyList)
						{
							for(var count = 0;count < result.hierarchyList.length;count++)
				        	{
				        		  var tempItem = result.hierarchyList[count];
				        		  if(tempItem)
				        		  {
				        			  var item = {label:tempItem.taxonName,tsn:tempItem.tsn,detail:tempItem,hasChildren:true};
				        			  arrSource.push(item);
				        		  }
				        	}
						}
						if(arrSource && arrSource.length > 0)
						{
							nsServerHierarchical.addItemsAsChildren(lastItem.item,arrSource);
						}
						else
						{
							lastItem.item.hasChildren = false;
							nsServerHierarchical.updateListItemByIndex(lastItem.rowIndex);
						}
					}
					lastItem = null;
					//console.log(result);
				}
